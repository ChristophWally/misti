# Story 002.003.3: Decommission Legacy Tag Arrays

**Epic**: Complete Conjugation System Architectural Rebuild

**As a** developer and system architect  
**I want** to safely remove the legacy `tags` columns from all core tables after verifying complete migration to the unified metadata architecture  
**So that** the system has a single source of truth for metadata, eliminates data redundancy, and simplifies maintenance

---

## Background & Problem Statement

After successful implementation of Story 002.003.1, we now have **dual data storage** across all core tables:

### Current State (Post-002.003.1):
- **Legacy `tags` columns**: Original `string[]` arrays still present with original data
- **New `metadata` + `optional_tags`**: Unified schema with migrated structured data
- **Data Redundancy**: Same information stored in two different formats
- **Maintenance Risk**: Potential for data drift between old and new formats

### System Impact:
- Database storage inefficiency with duplicate data
- Confusion for developers about which data source to use
- Risk of inconsistency if legacy tags accidentally modified
- Increased complexity in queries and application logic

---

## Solution: Phased Legacy Decommissioning

### **Phase 1: Validation & Verification**
- Comprehensive data comparison between legacy tags and new metadata
- Automated verification that 100% of legacy tag data has been preserved
- Application behavior testing to ensure new metadata structure provides equivalent functionality
- Performance comparison to confirm new structure meets or exceeds legacy performance

### **Phase 2: Application Migration**
- Update all remaining application code to use new metadata structure
- Remove any dependencies on legacy `tags` columns
- Update UI components, APIs, and business logic
- Comprehensive testing with new metadata-only approach

### **Phase 3: Safe Decommissioning**
- Archive legacy `tags` data for historical reference
- Remove legacy `tags` columns from all core tables
- Clean up backup procedures and documentation
- Update database schema documentation

---

## Acceptance Criteria

### Data Validation
- [ ] **100% data equivalence** verified between legacy tags and new metadata
- [ ] **Zero functional regression** confirmed when using only new metadata structure
- [ ] **Performance parity** maintained or improved without legacy columns
- [ ] **Backup strategy** updated for new metadata-only approach

### Application Migration  
- [ ] **All application code** updated to use unified metadata structure
- [ ] **Legacy tag references** completely removed from codebase
- [ ] **Migration tools** work exclusively with new metadata
- [ ] **UI components** display only new metadata structure

### Safe Decommissioning
- [ ] **Legacy data archived** for historical reference before column removal
- [ ] **Database schema cleanup** completed across all 4 core tables
- [ ] **Documentation updated** to reflect new metadata-only architecture
- [ ] **Rollback procedures** updated for new single-schema approach

---

## Definition of Done

- [ ] Legacy `tags` columns safely removed from all 4 core tables (dictionary, word_forms, word_translations, form_translations)
- [ ] All application functionality verified to work with unified metadata structure only
- [ ] Zero data loss and zero functional regression confirmed
- [ ] Database storage optimized with elimination of redundant data
- [ ] Documentation and processes updated for metadata-only architecture
- [ ] System maintainability significantly improved through single source of truth

---

## Risk Mitigation

**Data Loss Risk**: Comprehensive archival and verification before any column removal  
**Regression Risk**: Extensive testing and staged rollout of metadata-only approach  
**Integration Risk**: Coordinate with all dependent stories and team members  
**Rollback Risk**: Updated rollback procedures for new single-schema architecture

**Dependencies**: 
- **Prerequisite**: Story 002.003.1 (Tag Schema Restructure Migration) must be 100% complete and verified
- **Coordinate with**: Story 002.003.2 (Migration Tool Rebuild) for optimal integration
- **Impact**: All future EPICs will work exclusively with unified metadata architecture

---

## Notes

**Priority**: Medium - This is cleanup work that improves maintainability but is not blocking for core functionality

**Timing**: Should be completed after Story 002.003.2 is fully implemented and tested to ensure migration tools work correctly with metadata-only approach

**Scope**: This story focuses exclusively on decommissioning legacy columns. No new functionality or features should be added.

**Testing Strategy**: Comprehensive regression testing required to ensure equivalent functionality with metadata-only approach.